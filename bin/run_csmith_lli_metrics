#!/bin/sh
# Generate metrics from a dir tree created by run_csmith_lli.
# The current directory is assumed to be the root of the run_csmith_lli output
# tree.
#
# Csmith-generated programs in the PASSED subdirectory are counted as having
# passed, those in the KILLED subdirectory are counted as killed (the test
# program did not run to completion), and those in the run_csmith_lli root
# directory are counted as needing investigation.   

total=`find . -iname \*report | grep -c ^` 
need_investigation=`find . -maxdepth 1 -iname \*report | grep -c ^` 
passed=`find PASSED -iname \*report | grep -c ^` 
killed=`find KILLED -iname \*report | grep -c ^` 
tool_issue=`find TOOL_ISSUE -iname \*report | grep -c ^` 
interesting=`find INTERESTING -iname \*report | grep -c ^` 
uninteresting=`find UNINTERESTING -iname \*report | grep -c ^` 


total_percent=100
need_investigation_percent=$(( $need_investigation * 100 / $total ))
passed_percent=$(( $passed * 100 / $total ))
killed_percent=$(( $killed * 100 / $total ))

tool_issue_percent=$(( $tool_issue * 100 / $total ))
interesting_percent=$(( $interesting * 100 / $total ))
uninteresting_percent=$(( $uninteresting * 100 / $total ))

echo total: $total \(100%\)
echo " "
echo need_investigation: \
      $need_investigation \($need_investigation_percent%\)
echo passed: $passed \($passed_percent%\)
echo killed: $killed \($killed_percent%\)

echo tool_issue: $tool_issue \($tool_issue_percent%\)
echo interesting: $interesting \($interesting_percent%\)
echo uninteresting: $uninteresting \($uninteresting_percent%\)
echo " "
echo \(Total percentages may not equal 100 due to rounding.\)
echo " "

